{% extends "layout.html" %}
{% block content %}
<div id="gd-calendar">
  <div class="gd-head">
    <button onclick="window.location.href='?m=prev'">◀</button>
    <h1 style="margin:0">{{ month_title or "Kalendář" }}</h1>
    <button onclick="window.location.href='?m=next'">▶</button>
  </div>

  <div class="gd-actions">
    <a class="btn btn-green" href="/notes/new">+ Poznámka</a>
    <a class="btn btn-green" href="/tasks/new">+ Úkol</a>
    <a class="btn btn-green" href="/jobs/new">+ Zakázka</a>
  </div>

  <div class="gd-panel">
    <div class="gd-gridwrap">
      <!-- Weekday header -->
      <div class="gd-grid" aria-hidden="true" style="margin-bottom:6px;">
        {% for wd in ["Po","Út","St","Čt","Pá","So","Ne"] %}
          <div style="opacity:.8; font-weight:600;">{{ wd }}</div>
        {% endfor %}
      </div>

      <!-- Days grid -->
      <div class="gd-grid">
        {# Expect a flat list "days" each with fields: day_num, events (list of dicts {title}).
           If not provided, render 31 empty cells as a safe fallback. #}
        {% set _days = days or [] %}
        {% if not _days or _days|length < 28 %}
          {% for i in range(1, 32) %}
            <div class="gd-day">
              <div class="gd-date">{{ i }}.</div>
              <div class="gd-events"></div>
            </div>
          {% endfor %}
        {% else %}
          {% for d in _days %}
            <div class="gd-day">
              <div class="gd-date">{{ d.day_num }}.</div>
              <div class="gd-events">
                {% for e in d.events %}
                  <div class="gd-ev">
                    <div class="t">{{ e.title }}</div>
                    <div class="x">×</div>
                  </div>
                {% endfor %}
              </div>
            </div>
          {% endfor %}
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}