
{% extends "layout.html" %}
{% block title %}Archiv zakázek{% endblock %}
{% block content %}
<h1>Archiv zakázek</h1>
<p><a href="/?tab=jobs">← Zpět na zakázky</a></p>

{% if not years or years|length == 0 %}
<div class="alert">V archivu zatím nic není.</div>
{% else %}
  {% for y, items in years %}
    <h2 style="margin-top:18px">{{ y }}</h2>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px">
      {% for ym, jobs in items %}
        {% set mname = (ym ~ "-01")|tojson %}
        <div class="card" style="background:#2f3337;border-radius:12px;padding:12px">
          <div>
            <strong style="text-transform:capitalize">
              {{ (ym ~ "-01")|safe and (ym ~ "-01") }}
            </strong>
            <span style="opacity:.7">({{ jobs|length }})</span>
          </div>
          <ul style="margin:8px 0 0 16px;padding:0">
            {% for j in jobs %}
              <li style="margin:4px 0">
                {{ j.title or 'bez názvu' }}{% if j.client %} · {{ j.client }}{% endif %}{% if j.city %} · {{ j.city }}{% endif %}
                &nbsp; <a href='/?tab=jobs&jobId={{ j.id }}'>Detail</a> · <a href='/?tab=jobs&editId={{ j.id }}'>Upravit</a>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% endfor %}
    </div>
  {% endfor %}
{% endif %}
{% endblock %}
