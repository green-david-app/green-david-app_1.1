{% extends "layout.html" %}
{% block title %}archiv zakázek{% endblock %}
{% block content %}
<div class="page">
  <div class="container">
    <h1>Archiv zakázek</h1>
    <p style="margin-bottom: 24px;"><a href="/?tab=jobs" class="link">← Zpět na zakázky</a></p>

    {% if not years or years|length == 0 %}
    <div class="card">
      <div class="card-c">
        <div class="empty-state">
          <div class="empty-text">V archivu zatím nic není.</div>
        </div>
      </div>
    </div>
    {% else %}
      {% for y, items in years %}
        <h2 style="margin-top:24px; margin-bottom:16px; color:var(--text-primary);">{{ y }}</h2>
        <div class="archive-grid">
          {% for ym, jobs in items %}
            <div class="archive-month-card">
              <div class="archive-month-head">
                <div class="archive-month-title">
                  {% set month_num = (ym|string).split('-')[1]|int %}
                  {% set month_names = ['Leden', 'Únor', 'Březen', 'Duben', 'Květen', 'Červen', 'Červenec', 'Srpen', 'Září', 'Říjen', 'Listopad', 'Prosinec'] %}
                  {{ month_names[month_num - 1] }}
                </div>
                <div class="archive-month-count">{{ jobs|length }} zakázek</div>
              </div>
              <div class="archive-month-body">
                {% for j in jobs %}
                  <div class="archive-job-row">
                    <div class="archive-job-main">
                      <div class="archive-job-title">{{ j.title or 'bez názvu' }}</div>
                      <div style="font-size:13px; color:var(--text-tertiary); margin-top:2px;">
                        {% if j.client %}{{ j.client }}{% endif %}{% if j.client and j.city %} · {% endif %}{% if j.city %}{{ j.city }}{% endif %}
                      </div>
                    </div>
                    <div class="archive-job-actions">
                      <a href='/?tab=jobs&jobId={{ j.id }}' class="btn btn-ghost btn-sm">Detail</a>
                    </div>
                  </div>
                {% endfor %}
              </div>
            </div>
          {% endfor %}
        </div>
      {% endfor %}
    {% endif %}
  </div>
</div>
{% endblock %}
