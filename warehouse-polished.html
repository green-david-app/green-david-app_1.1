<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Sklad - Green David</title>
  <link rel="stylesheet" href="/static/style.css"/>
  <link rel="stylesheet" href="/static/css/app.css"/>
  <script src="/app-settings.js"></script>
  <style>
    .action-btn {
      padding: 6px 10px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .action-btn:hover { transform: translateY(-1px); }
    .action-btn svg { width: 14px; height: 14px; }
    .action-btn.success { background: rgba(178, 251, 165, 0.15); color: #B2FBA5; }
    .action-btn.danger { background: rgba(248, 113, 113, 0.15); color: #f87171; }
    .action-btn.edit { background: rgba(156, 168, 179, 0.15); color: #9ca8b3; }
    .table-row { transition: background 0.2s; }
    .table-row:hover { background: rgba(159, 212, 161, 0.05); }
  </style>
</head>
<body>
  <div id="app-header"></div>

  <div class="warehouse-page">
    <h1 style="display:flex;align-items:center;gap:12px;">
      <svg style="width:32px;height:32px;" viewBox="0 0 24 24" fill="none" stroke="#B2FBA5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
        <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
        <line x1="12" y1="22.08" x2="12" y2="12"/>
      </svg>
      Sklad
    </h1>
    <div class="header-actions">
      <button class="btn-secondary" onclick="exportData()">
        <svg style="width:18px;height:18px;display:inline-block;vertical-align:middle;margin-right:6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
        Export
      </button>
      <button class="btn-primary" onclick="openNewItemModal()">+ Nová položka</button>
    </div>
  </div>

  <!-- Statistics -->
  <div class="warehouse-stats">
    <div class="stat-box">
      <div class="stat-number" id="statTotalValue">0 Kč</div>
      <div class="stat-label">Celková hodnota</div>
    </div>
    <div class="stat-box">
      <div class="stat-number" id="statTotalItems">0</div>
      <div class="stat-label">Celkem položek</div>
    </div>
    <div class="stat-box warning">
      <div class="stat-number" id="statLowStock">0</div>
      <div class="stat-label" style="display:flex;align-items:center;gap:6px;">
        <svg style="width:16px;height:16px;" viewBox="0 0 24 24" fill="none" stroke="#fb923c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
        </svg>
        Nízký stav
      </div>
    </div>
    <div class="stat-box danger">
      <div class="stat-number" id="statOutOfStock">0</div>
      <div class="stat-label" style="display:flex;align-items:center;gap:6px;">
        <svg style="width:16px;height:16px;" viewBox="0 0 24 24" fill="none" stroke="#f87171" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
        Nedostupné
      </div>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-bar">
    <div class="search-box">
      <input type="search" id="searchInput" placeholder="Hledat položky..." oninput="filterItems()">
    </div>
    <select class="filter-select" id="filterCategory" onchange="filterItems()">
      <option value="">Všechny kategorie</option>
      <option value="substrát">Substrát</option>
      <option value="hnojivo">Hnojivo</option>
      <option value="mulč">Mulč</option>
      <option value="rostliny">Rostliny</option>
      <option value="nářadí">Nářadí</option>
      <option value="ostatní">Ostatní</option>
    </select>
    <select class="filter-select" id="filterStatus" onchange="filterItems()">
      <option value="">Všechny stavy</option>
      <option value="in_stock">Skladem</option>
      <option value="low_stock">Málo</option>
      <option value="out_of_stock">Nedostupné</option>
    </select>
  </div>

  <!-- Inventory Table -->
  <div class="inventory-table">
    <div class="table-header">
      <div>Položka</div>
      <div>Kategorie</div>
      <div>Množství</div>
      <div>Jednotka</div>
      <div>Cena/j</div>
      <div>Status</div>
      <div style="text-align:right;">Akce</div>
    </div>
    <div id="itemsList"></div>
  </div>

  <!-- Movement History + Top Items -->
  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(400px, 1fr));gap:24px;margin-top:32px;">
    <div class="history-section">
      <div class="section-header">
        <h3 style="display:flex;align-items:center;gap:8px;">
          <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 3v5h5"/><path d="M3.05 13A9 9 0 1 0 6 5.3L3 8"/>
          </svg>
          Historie pohybů
        </h3>
        <button class="btn-secondary" style="padding:6px 12px;font-size:12px;" onclick="clearHistory()">Vymazat</button>
      </div>
      <div id="historyList"></div>
    </div>

    <div class="history-section">
      <div class="section-header">
        <h3 style="display:flex;align-items:center;gap:8px;">
          <svg style="width:20px;height:20px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
          </svg>
          Nejpoužívanější
        </h3>
      </div>
      <div id="topItemsList" class="top-items-list"></div>
    </div>
  </div>

  <!-- New/Edit Item Modal -->
  <div class="item-modal" id="itemModal" style="display:none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitle">Nová položka</h2>
        <button class="close-modal" onclick="closeModal()">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>Název *</label>
          <input type="text" id="itemName" required placeholder="Substrát univerzální">
        </div>
        <div class="form-group">
          <label>Kategorie</label>
          <select id="itemCategory">
            <option value="substrát">Substrát</option>
            <option value="hnojivo">Hnojivo</option>
            <option value="mulč">Mulč</option>
            <option value="rostliny">Rostliny</option>
            <option value="nářadí">Nářadí</option>
            <option value="ostatní">Ostatní</option>
          </select>
        </div>
        <div class="form-group">
          <label>Množství *</label>
          <input type="number" id="itemQuantity" required value="0" min="0" step="0.1">
        </div>
        <div class="form-group">
          <label>Jednotka *</label>
          <select id="itemUnit">
            <option value="ks">ks</option>
            <option value="kg">kg</option>
            <option value="L">L</option>
            <option value="m3">m³</option>
            <option value="balení">balení</option>
          </select>
        </div>
        <div class="form-group">
          <label>Cena za jednotku (Kč)</label>
          <input type="number" id="itemPrice" step="0.01" placeholder="50">
        </div>
        <div class="form-group">
          <label>Minimální stav (alert)</label>
          <input type="number" id="itemMinStock" value="10" min="0" step="0.1">
        </div>
        <div class="form-group">
          <label>Dodavatel</label>
          <input type="text" id="itemSupplier" placeholder="Zahradnictví XY">
        </div>
        <div class="form-group">
          <label>Lokace skladu</label>
          <input type="text" id="itemLocation" placeholder="Sklad A, police 3">
        </div>
      </div>
      <div style="display:flex;justify-content:flex-end;gap:12px;padding:20px;border-top:1px solid var(--border-primary);">
        <button class="btn-secondary" onclick="closeModal()">Zavřít</button>
        <button class="btn-primary" onclick="saveItem()">Uložit</button>
      </div>
    </div>
  </div>

  <!-- Movement Modal -->
  <div class="item-modal" id="movementModal" style="display:none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="movementTitle">Pohyb materiálu</h2>
        <button class="close-modal" onclick="closeMovementModal()">×</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="movementItemId">
        <input type="hidden" id="movementType">
        <div class="form-group">
          <label>Položka</label>
          <input type="text" id="movementItemName" readonly style="background:#1a2027;">
        </div>
        <div class="form-group">
          <label>Množství *</label>
          <input type="number" id="movementQuantity" required step="0.1" min="0.1">
        </div>
        <div class="form-group">
          <label>Cena za jednotku (Kč)</label>
          <input type="number" id="movementPrice" step="0.01">
        </div>
        <div class="form-group" id="jobField" style="display:none;">
          <label>Zakázka</label>
          <select id="movementJob">
            <option value="">-- Vyberte zakázku --</option>
          </select>
        </div>
        <div class="form-group">
          <label>Datum</label>
          <input type="date" id="movementDate">
        </div>
        <div class="form-group">
          <label>Poznámka</label>
          <input type="text" id="movementNotes" placeholder="Dodávka/použití">
        </div>
      </div>
      <div style="display:flex;justify-content:flex-end;gap:12px;padding:20px;border-top:1px solid var(--border-primary);">
        <button class="btn-secondary" onclick="closeMovementModal()">Zavřít</button>
        <button class="btn-primary" onclick="submitMovement()">Potvrdit</button>
      </div>
    </div>
  </div>

  <div id="bottom-nav"></div>
  <script src="/static/bottom-nav.js"></script>
  <script src="/static/app-header.js"></script>
  <script src="/static/navigation.js"></script>
  <script src="/static/toast.js"></script>
  <script src="/static/loading.js"></script>

  <script>
    let items = [];
    let history = [];
    let allJobs = [];
    let currentEditId = null;

    async function loadData() {
      try {
        const [matsResp, jobsResp, histResp] = await Promise.all([
          fetch('/api/materials'),
          fetch('/api/jobs'),
          fetch('/api/materials/movements')
        ]);
        
        const matsData = await matsResp.json();
        const jobsData = await jobsResp.json();
        const histData = await histResp.json();
        
        if (matsData.success) items = matsData.materials || [];
        allJobs = jobsData || [];
        if (histData.success) history = histData.movements || [];
        
        renderItems();
        updateStats();
        renderHistory();
        renderTopItems();
      } catch (error) {
        console.error('Error:', error);
        showToast('Chyba načítání dat', 'error');
      }
    }

    function renderItems() {
      const list = document.getElementById('itemsList');
      if (items.length === 0) {
        list.innerHTML = '<div style="padding:60px;text-align:center;color:#6b7580;font-size:15px;">Žádné položky. Přidej první!</div>';
        return;
      }

      let html = '';
      items.forEach(item => {
        const status = getStatus(item);
        const statusClass = status === 'out_of_stock' ? 'danger' : status === 'low_stock' ? 'warning' : 'success';
        const statusText = status === 'out_of_stock' ? 'Nedostupné' : status === 'low_stock' ? 'Nízký stav' : 'Skladem';
        
        html += `<div class="table-row">`;
        html += `<div><strong style="font-size:14px;">${item.name}</strong>`;
        if (item.location) html += `<div style="font-size:12px;color:#6b7580;margin-top:2px;">${item.location}</div>`;
        html += `</div>`;
        html += `<div><span class="badge">${item.category || '-'}</span></div>`;
        html += `<div><strong style="font-size:15px;">${item.current_stock}</strong></div>`;
        html += `<div style="color:#9ca8b3;">${item.unit}</div>`;
        html += `<div>${item.unit_price ? item.unit_price.toLocaleString('cs-CZ') + ' Kč' : '-'}</div>`;
        html += `<div><span class="badge badge-${statusClass}">${statusText}</span></div>`;
        html += `<div style="text-align:right;display:flex;gap:6px;justify-content:flex-end;">`;
        html += `<button class="action-btn success" onclick="openMovementModal(${item.id}, 'in')" title="Příjem">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        </button>`;
        html += `<button class="action-btn danger" onclick="openMovementModal(${item.id}, 'out')" title="Spotřeba">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/></svg>
        </button>`;
        html += `<button class="action-btn edit" onclick="editItem(${item.id})" title="Upravit">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
        </button>`;
        html += `</div>`;
        html += `</div>`;
      });
      
      list.innerHTML = html;
    }

    function getStatus(item) {
      if (item.current_stock === 0) return 'out_of_stock';
      if (item.current_stock < item.min_stock) return 'low_stock';
      return 'in_stock';
    }

    function updateStats() {
      const totalValue = items.reduce((sum, item) => sum + (item.current_stock * (item.unit_price || 0)), 0);
      const lowStock = items.filter(item => item.current_stock > 0 && item.current_stock < item.min_stock).length;
      const outOfStock = items.filter(item => item.current_stock === 0).length;
      
      document.getElementById('statTotalValue').textContent = Math.round(totalValue).toLocaleString('cs-CZ') + ' Kč';
      document.getElementById('statTotalItems').textContent = items.length;
      document.getElementById('statLowStock').textContent = lowStock;
      document.getElementById('statOutOfStock').textContent = outOfStock;
    }

    function filterItems() {
      const search = document.getElementById('searchInput').value.toLowerCase();
      const category = document.getElementById('filterCategory').value;
      const status = document.getElementById('filterStatus').value;
      
      const rows = document.querySelectorAll('#itemsList .table-row');
      rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        const badges = row.querySelectorAll('.badge');
        const categoryBadge = badges[0]?.textContent;
        const statusBadge = badges[1];
        
        const matchSearch = text.includes(search);
        const matchCategory = !category || categoryBadge === category;
        
        let matchStatus = true;
        if (status) {
          if (status === 'in_stock') matchStatus = statusBadge?.classList.contains('badge-success');
          if (status === 'low_stock') matchStatus = statusBadge?.classList.contains('badge-warning');
          if (status === 'out_of_stock') matchStatus = statusBadge?.classList.contains('badge-danger');
        }
        
        row.style.display = matchSearch && matchCategory && matchStatus ? '' : 'none';
      });
    }

    function openNewItemModal() {
      document.getElementById('modalTitle').textContent = 'Nová položka';
      currentEditId = null;
      clearForm();
      document.getElementById('itemModal').style.display = 'flex';
    }

    function editItem(id) {
      const item = items.find(i => i.id === id);
      if (!item) return;
      
      document.getElementById('modalTitle').textContent = 'Upravit položku';
      currentEditId = id;
      
      document.getElementById('itemName').value = item.name;
      document.getElementById('itemCategory').value = item.category || 'substrát';
      document.getElementById('itemQuantity').value = item.current_stock;
      document.getElementById('itemUnit').value = item.unit;
      document.getElementById('itemPrice').value = item.unit_price || '';
      document.getElementById('itemMinStock').value = item.min_stock;
      document.getElementById('itemSupplier').value = item.supplier || '';
      document.getElementById('itemLocation').value = item.location || '';
      
      document.getElementById('itemModal').style.display = 'flex';
    }

    function clearForm() {
      document.getElementById('itemName').value = '';
      document.getElementById('itemCategory').value = 'substrát';
      document.getElementById('itemQuantity').value = '0';
      document.getElementById('itemUnit').value = 'ks';
      document.getElementById('itemPrice').value = '';
      document.getElementById('itemMinStock').value = '10';
      document.getElementById('itemSupplier').value = '';
      document.getElementById('itemLocation').value = '';
    }

    async function saveItem() {
      const data = {
        name: document.getElementById('itemName').value,
        category: document.getElementById('itemCategory').value,
        current_stock: parseFloat(document.getElementById('itemQuantity').value),
        unit: document.getElementById('itemUnit').value,
        unit_price: parseFloat(document.getElementById('itemPrice').value) || null,
        min_stock: parseFloat(document.getElementById('itemMinStock').value) || 0,
        supplier: document.getElementById('itemSupplier').value || null,
        location: document.getElementById('itemLocation').value || null
      };

      try {
        const url = currentEditId ? `/api/materials/${currentEditId}` : '/api/materials';
        const method = currentEditId ? 'PUT' : 'POST';
        
        const response = await fetch(url, {
          method: method,
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          showToast(currentEditId ? '✓ Položka upravena!' : '✓ Položka přidána!', 'success');
          closeModal();
          loadData();
        } else {
          showToast('Chyba: ' + result.error, 'error');
        }
      } catch (error) {
        showToast('Chyba: ' + error, 'error');
      }
    }

    function openMovementModal(itemId, type) {
      const item = items.find(i => i.id === itemId);
      if (!item) return;
      
      document.getElementById('movementItemId').value = itemId;
      document.getElementById('movementType').value = type;
      document.getElementById('movementItemName').value = item.name;
      document.getElementById('movementTitle').textContent = type === 'in' ? 'Příjem materiálu' : 'Spotřeba materiálu';
      document.getElementById('movementDate').valueAsDate = new Date();
      document.getElementById('jobField').style.display = type === 'out' ? 'block' : 'none';
      
      const jobSelect = document.getElementById('movementJob');
      jobSelect.innerHTML = '<option value="">-- Vyberte zakázku --</option>';
      allJobs.forEach(j => {
        jobSelect.innerHTML += `<option value="${j.id}">${j.name}</option>`;
      });
      
      document.getElementById('movementModal').style.display = 'flex';
    }

    async function submitMovement() {
      const data = {
        material_id: parseInt(document.getElementById('movementItemId').value),
        movement_type: document.getElementById('movementType').value,
        quantity: parseFloat(document.getElementById('movementQuantity').value),
        unit_price: parseFloat(document.getElementById('movementPrice').value) || null,
        movement_date: document.getElementById('movementDate').value,
        notes: document.getElementById('movementNotes').value || null
      };

      if (data.movement_type === 'out') {
        const jobId = document.getElementById('movementJob').value;
        if (jobId) data.job_id = parseInt(jobId);
      }

      if (data.unit_price) data.total_price = data.quantity * data.unit_price;

      try {
        const response = await fetch('/api/materials/movement', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          showToast(data.movement_type === 'in' ? '✓ Příjem zaznamenán!' : '✓ Spotřeba zaznamenána!', 'success');
          closeMovementModal();
          loadData();
        } else {
          showToast('Chyba: ' + result.error, 'error');
        }
      } catch (error) {
        showToast('Chyba: ' + error, 'error');
      }
    }

    function closeModal() {
      document.getElementById('itemModal').style.display = 'none';
      clearForm();
      currentEditId = null;
    }

    function closeMovementModal() {
      document.getElementById('movementModal').style.display = 'none';
      document.getElementById('movementQuantity').value = '';
      document.getElementById('movementPrice').value = '';
      document.getElementById('movementNotes').value = '';
    }

    function renderHistory() {
      const list = document.getElementById('historyList');
      if (history.length === 0) {
        list.innerHTML = '<div style="padding:20px;text-align:center;color:#6b7580;font-size:13px;">Zatím žádná historie</div>';
        return;
      }
      
      let html = '';
      history.slice(0, 10).forEach(h => {
        const icon = h.movement_type === 'in' 
          ? '<svg style="width:16px;height:16px;" viewBox="0 0 24 24" fill="none" stroke="#B2FBA5" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>'
          : '<svg style="width:16px;height:16px;" viewBox="0 0 24 24" fill="none" stroke="#f87171" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/></svg>';
        
        html += `<div style="padding:12px;border-bottom:1px solid var(--border-primary);font-size:13px;">`;
        html += `<div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">`;
        html += icon;
        html += `<strong>${h.material_name || 'Materiál'}</strong>`;
        html += `<span style="margin-left:auto;color:#6b7580;">${h.quantity} ${h.unit}</span>`;
        html += `</div>`;
        if (h.job_name) html += `<div style="color:#6b7580;font-size:12px;">→ ${h.job_name}</div>`;
        html += `<div style="color:#6b7580;font-size:11px;">${h.movement_date}</div>`;
        html += `</div>`;
      });
      list.innerHTML = html;
    }

    function renderTopItems() {
      const list = document.getElementById('topItemsList');
      const topItems = items.filter(i => i.current_stock > 0).sort((a,b) => b.current_stock - a.current_stock).slice(0, 5);
      
      if (topItems.length === 0) {
        list.innerHTML = '<div style="padding:20px;text-align:center;color:#6b7580;font-size:13px;">Zatím žádné položky</div>';
        return;
      }
      
      let html = '';
      topItems.forEach((item, idx) => {
        html += `<div style="display:flex;align-items:center;gap:12px;padding:12px;border-bottom:1px solid var(--border-primary);">`;
        html += `<div style="font-size:18px;font-weight:700;color:#6b7580;min-width:24px;">#${idx+1}</div>`;
        html += `<div style="flex:1;">`;
        html += `<div style="font-weight:600;font-size:14px;">${item.name}</div>`;
        html += `<div style="font-size:12px;color:#6b7580;">${item.current_stock} ${item.unit}</div>`;
        html += `</div>`;
        html += `</div>`;
      });
      list.innerHTML = html;
    }

    function clearHistory() {
      if (!confirm('Opravdu smazat celou historii?')) return;
      history = [];
      renderHistory();
      showToast('Historie vymazána', 'success');
    }

    function exportData() {
      let csv = 'Název,Kategorie,Množství,Jednotka,Cena/j,Min stav,Dodavatel,Lokace\n';
      items.forEach(item => {
        csv += `"${item.name}","${item.category || ''}",${item.current_stock},"${item.unit}",${item.unit_price || ''},${item.min_stock},"${item.supplier || ''}","${item.location || ''}"\n`;
      });
      
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `sklad_${new Date().toISOString().split('T')[0]}.csv`;
      a.click();
      showToast('✓ Export hotov', 'success');
    }

    function showToast(message, type) {
      if (window.showToast) {
        window.showToast(message, type);
      } else {
        alert(message);
      }
    }

    document.getElementById('itemModal').addEventListener('click', (e) => {
      if (e.target.id === 'itemModal') closeModal();
    });
    document.getElementById('movementModal').addEventListener('click', (e) => {
      if (e.target.id === 'movementModal') closeMovementModal();
    });

    loadData();
  </script>
</body>
</html>
