<!doctype html><html lang="cs"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Výkazy – Green David</title><link rel="stylesheet" href="/style.css"></head>
<body><header><h1>Green David – Výkazy</h1><nav><a href="/">Zakázky</a> · <a href="/calendar.html">Kalendář</a></nav></header>
<main style="max-width:800px;margin:18px auto;padding:10px">
<h2>Nový záznam</h2>
<div style="display:grid;grid-template-columns:2fr 2fr 1fr 1fr 2fr;gap:8px;align-items:center;margin-bottom:8px">
  <input id="emp" placeholder="Zaměstnanec *">
  <input id="job" placeholder="Zakázka (název)">
  <input id="hours" placeholder="Hodiny *" type="number" step="0.25">
  <input id="date" placeholder="Datum * (DD.MM.RRRR)">
  <input id="note" placeholder="Poznámka">
</div>
<button id="btn">Uložit</button> <span id="msg"></span>
<h2 style="margin-top:18px">Poslední záznamy</h2>
<div id="list"></div>
</main>
<script>
async function j(u,o={}){const r=await fetch(u,Object.assign({headers:{'Content-Type':'application/json'}},o));if(!r.ok)throw new Error(await r.text());return r.json();}
async function load(){const d=await j('/api/worklogs');const box=document.getElementById('list');const rows=d.work_logs||[];
 if(rows.length===0){box.innerHTML='<div class=empty>Žádné výkazy.</div>';return;}
 box.innerHTML=rows.map(w=>`<div class=card><b>${w.employee_name}</b> · ${w.hours} h · ${w.work_date} · ${w.job_title||''}${w.note?('<br>'+w.note):''}</div>`).join('');}
document.getElementById('btn').addEventListener('click', async ()=>{
 const p={employee_name:emp.value,job_title:job.value,hours:parseFloat(hours.value||'0'),work_date:date.value,note:note.value};
 try{await j('/api/worklogs',{method:'POST',body:JSON.stringify(p)});msg.textContent='Uloženo ✔';load();}catch(e){msg.textContent='Chyba při ukládání';}
});
load();
</script>
</body></html>
