<!doctype html>
<html lang="cs"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Zaměstnanci — green david app</title>
<link rel="stylesheet" href="/style.css"></head>
<body><div class="page-pad">
<div class="tabs sticky">
<a href="/calendar">Kalendář</a>
<a href="/timesheets.html">Výkazy hodin</a>
<a href="/jobs">Zakázky</a>
<a class="active" href="/employees.html">Zaměstnanci</a>
<a href="/brigadnici.html">Brigádníci</a>
<a href="/stock">Sklad</a>
<a href="/users">Uživatelé</a>
</div>
<div class="card card-dark"><div class="card-h"><strong>Nový zaměstnanec</strong></div>
<div class="card-c"><div class="row">
<input id="newName" type="text" placeholder="Jméno" class="inp" />
<select id="newRole" class="inp sel">
<option value="zahradník">Zahradník</option>
<option value="svářeč">Svářeč</option>
<option value="brigádník">Brigádník</option>
<option value="jiné">Jiné</option>
</select>
<button id="btnAdd" class="btn btn-primary">Přidat</button>
</div></div></div>
<div class="card card-dark"><div class="card-h"><strong>Seznam</strong>
<div class="chips" style="margin-top:8px;">
<button data-scope="all" class="chip chip-on">Všichni</button>
<button data-scope="employees" class="chip">Zaměstnanci</button>
<button data-scope="brig" class="chip">Brigádníci</button>
</div></div>
<div class="card-c"><table class="tbl">
<thead><tr><th>Č.</th><th>Jméno</th><th>Role</th><th style="width:220px"></th></tr></thead>
<tbody id="listBody"></tbody></table></div></div>
</div>
<script>
(async function(){
const listBody=document.getElementById('listBody');
const newName=document.getElementById('newName');
const newRole=document.getElementById('newRole');
const btnAdd=document.getElementById('btnAdd');
const chips=Array.from(document.querySelectorAll('.chips .chip'));
let scope='all';
async function fetchJSON(u){const r=await fetch(u); if(!r.ok) throw new Error(await r.text()); return r.json();}
async function apiJSON(u,o){const r=await fetch(u,Object.assign({headers:{'Content-Type':'application/json'}},o||{})); if(!r.ok) throw new Error(await r.text()); return r.json();}
btnAdd.addEventListener('click', async ()=>{
  const name=newName.value.trim(); const role=newRole.value; if(!name) return;
  await apiJSON('/api/employees',{method:'POST',body:JSON.stringify({name,role})}); newName.value=''; await render();
});
chips.forEach(ch=>ch.addEventListener('click',()=>{chips.forEach(c=>c.classList.remove('chip-on')); ch.classList.add('chip-on'); scope=ch.getAttribute('data-scope'); render();}));
async function render(){
  listBody.innerHTML='<tr><td colspan="4" class="muted">Načítám…</td></tr>';
  const data=await fetchJSON('/api/employees'+(scope!=='all'?('?scope='+encodeURIComponent(scope)):""));
  const rows=data.employees||[];
  if(rows.length===0){listBody.innerHTML='<tr><td colspan="4" class="muted">Žádné položky</td></tr>'; return;}
  listBody.innerHTML=''; let i=0;
  for(const e of rows){ i+=1; const tr=document.createElement('tr');
    tr.innerHTML=`<td>${i}</td><td>${e.name}</td><td>${e.role||''}</td>
    <td><a class="btn btn-small">Detail</a> <a class="btn btn-small btn-danger">Smazat</a></td>`;
    listBody.appendChild(tr);
  }
}
await render(); })();
</script>
</body></html>