
{% set title = title or 'green david app' %}
<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>{{ title }}</title>
  <link rel="icon" href="/logo.svg"/>
  <link rel="stylesheet" href="/style.css"/>
</head>
<body>
  <div class="app-header">
    <div class="brand">
      <img src="/logo.svg" alt="GD" style="height:28px;vertical-align:middle;margin-right:8px"/>
      <div class="brand-text">green david app</div>
      <div class="brand-sub">interní systém</div>
    </div>
    <div class="user-area">
      {% if me %}Přihlášen: {{ me.name }}{% endif %}
      <a class="btn ghost" href="/logout">Odhlásit</a>
    </div>
  
  <form id="global-search" style="margin:10px 0;display:flex;gap:8px" action="/search" method="get">
    <input type="search" name="q" placeholder="Hledat..." style="flex:1;padding:6px 10px;border-radius:6px;border:1px solid #444">
    <button class="btn ghost" type="submit">Hledat</button>
  </form>
</div>

  <div class="tabs" id="main-tabs">
    <!-- původní odkazy (Zakázky, Úkoly, …) se načtou ze stávajícího layoutu -->
  </div>

  <div class="container" style="margin-top: 12px;">
    {% block content %}{% endblock %}
  </div>

  <script>
  (function(){
    function insertTabs(){
      var tabs = document.querySelector('.tabs') || document.getElementById('main-tabs');
      if(!tabs) return;
      var first = tabs.querySelector('a') || null;
      function mk(href, label){
        var a = document.createElement('a');
        a.href = href;
        a.textContent = label;
        a.className = (first && first.className) ? first.className : 'tab';
        return a;
      }
      if(!tabs.querySelector('a[href="/calendar-page"]') && !tabs.querySelector('a[href="/calendar"]')){
        tabs.insertBefore(mk('/calendar-page','Kalendář'), first);
      }
      if(!tabs.querySelector('a[href="/timesheets-page"]') && !tabs.querySelector('a[href="/timesheets"]')){
        tabs.insertBefore(mk('/timesheets-page','Výkazy'), first);
      }
    }
    if(document.readyState==='loading'){ document.addEventListener('DOMContentLoaded', insertTabs); }
    else { insertTabs(); }
  })();
  </script>
</body>
</html>
