<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Sklad materi√°lu | Green David</title>
    <link rel="stylesheet" href="/static/style.css"/>
    <link rel="stylesheet" href="/static/css/app.css"/>
    <style>
        :root { --bg-primary: #0a0e11; --bg-card: #151a1e; --border-primary: #2d3439;
                --text-primary: #e8eef2; --text-secondary: #9ca8b3; --mint: #9FD4A1; }
        body { background: var(--bg-primary); color: var(--text-primary); margin: 0; }
        .container { padding: 20px; max-width: 1600px; margin: 0 auto; }
        
        .materials-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; }
        .material-card { background: var(--bg-card); border: 1px solid var(--border-primary); border-radius: 12px; padding: 16px; }
        .material-card.low-stock { border-left: 4px solid #ff6b6b; }
        .material-name { font-weight: 700; font-size: 16px; margin-bottom: 4px; }
        .material-category { font-size: 12px; color: var(--text-secondary); margin-bottom: 12px; }
        .stock-bar { height: 8px; background: var(--border-primary); border-radius: 4px; overflow: hidden; margin: 12px 0; }
        .stock-fill { height: 100%; background: var(--mint); }
        .stock-fill.low { background: #ff6b6b; }
        
        button { padding: 10px 20px; background: var(--mint); color: #0a0e11; border: none; 
                border-radius: 8px; font-weight: 600; cursor: pointer; }
    </style>
</head>
<body>
    <header style="background: var(--bg-card); border-bottom: 1px solid var(--border-primary); padding: 16px 20px;">
        <div style="display: flex; align-items: center; gap: 16px;">
            <a href="javascript:history.back()" style="padding: 8px 12px; background: var(--bg-card); border: 1px solid var(--border-primary); border-radius: 8px; text-decoration: none; color: var(--text-primary); font-weight: 600;">‚Üê Zpƒõt</a>
            <h1 style="margin: 0; font-size: 20px; font-weight: 700;">üì¶ Sklad materi√°lu</h1>
            <button onclick="showAddMaterial()" style="margin-left: auto;">+ P≈ôidat materi√°l</button>
        </div>
    </header>

    <div class="container">
        <div class="materials-grid" id="materialsGrid">
            <div style="grid-column: 1/-1; text-align: center; padding: 60px; color: var(--text-secondary);">Naƒç√≠t√°m materi√°ly...</div>
        </div>
    </div>

    <script>
        async function loadMaterials() {
            try {
                const response = await fetch('/api/materials');
                const data = await response.json();
                
                if (data.success) {
                    renderMaterials(data.materials);
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        function renderMaterials(materials) {
            if (materials.length === 0) {
                document.getElementById('materialsGrid').innerHTML = 
                    '<div style="grid-column: 1/-1; text-align: center; padding: 60px; color: var(--text-secondary);">≈Ω√°dn√© materi√°ly</div>';
                return;
            }

            let html = '';
            materials.forEach(m => {
                const stockPercent = m.min_stock > 0 ? (m.current_stock / m.min_stock) * 100 : 100;
                const isLow = m.low_stock_alert;

                html += `<div class="material-card ${isLow ? 'low-stock' : ''}">`;
                html += `<div class="material-name">${m.name}</div>`;
                html += `<div class="material-category">${m.category || 'Materi√°l'}</div>`;
                html += `<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">`;
                html += `<div style="font-size: 24px; font-weight: 700;">${m.current_stock} ${m.unit}</div>`;
                if (isLow) html += `<span style="color: #ff6b6b; font-size: 12px; font-weight: 600;">‚ö†Ô∏è N√çZK√ù STAV</span>`;
                html += `</div>`;
                html += `<div class="stock-bar"><div class="stock-fill ${isLow ? 'low' : ''}" style="width: ${Math.min(100, stockPercent)}%"></div></div>`;
                html += `<div style="font-size: 12px; color: var(--text-secondary);">Min. hladina: ${m.min_stock} ${m.unit}</div>`;
                html += `<div style="display: flex; gap: 8px; margin-top: 12px;">`;
                html += `<button onclick="addStock(${m.id})" style="flex: 1; font-size: 12px; padding: 8px;">‚ûï P≈ô√≠jem</button>`;
                html += `<button onclick="removeStock(${m.id})" style="flex: 1; font-size: 12px; padding: 8px; background: #ff6b6b;">‚ûñ Spot≈ôeba</button>`;
                html += `</div>`;
                html += `</div>`;
            });

            document.getElementById('materialsGrid').innerHTML = html;
        }

        function addStock(id) { alert('Add stock for ' + id); }
        function removeStock(id) { alert('Remove stock for ' + id); }
        function showAddMaterial() { alert('Add material modal'); }

        loadMaterials();
    </script>
</body>
</html>
